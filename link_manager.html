<!doctype html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Material Link Manager v2.0.2</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"><link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Round" rel="stylesheet"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet"><script type="module" crossorigin>!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const state={links:[],currentEditIndex:-1,sortableInstance:null,deletedLink:null,deletedLinkIndex:-1,pendingJsonImport:null,filterTag:"",filterKeyword:""};function setLinks(e){state.links=e}function setCurrentEditIndex(e){state.currentEditIndex=e}function setDeletedLink(e,t){state.deletedLink=e,state.deletedLinkIndex=t}function setPendingJsonImport(e){state.pendingJsonImport=e}function setFilter(e,t){state.filterTag=e,state.filterKeyword=t}function isWebUrl(e){return!!e&&/^(https?|ftp):\/\//i.test(e)}function getFileIconInfo(e){if(!e)return{icon:"insert_drive_file",color:"grey-text"};let t=String(e);const n=Math.max(t.lastIndexOf("/"),t.lastIndexOf("\\")),i=n>=0?t.substring(n+1):t,l=i.lastIndexOf(".");let s="";switch(l>0&&l<i.length-1&&(s=i.substring(l+1).toLowerCase()),s){case"xls":case"xlsx":case"csv":return{icon:"grid_on",color:"green-text"};case"doc":case"docx":return{icon:"description",color:"blue-text"};case"ppt":case"pptx":return{icon:"slideshow",color:"orange-text"};case"pdf":return{icon:"picture_as_pdf",color:"red-text"};case"jpg":case"jpeg":case"png":case"gif":case"svg":case"bmp":return{icon:"image",color:"purple-text"};case"zip":case"rar":case"7z":case"lzh":return{icon:"folder_zip",color:"brown-text"};case"txt":case"md":case"log":return{icon:"text_snippet",color:"grey-text text-darken-1"};case"html":case"js":case"css":case"json":return{icon:"code",color:"teal-text"};case"exe":case"bat":case"sh":return{icon:"terminal",color:"blue-grey-text"};default:return""===s?{icon:"folder",color:"amber-text text-darken-2"}:{icon:"insert_drive_file",color:"grey-text"}}}function highlightText(e){if(!e)return"";if(!state.filterKeyword)return e;const t=state.filterKeyword.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n=new RegExp(`(${t})`,"gi");return e.replace(n,'<span class="search-highlight">$1</span>')}function getTagColor(e){const t=[{bg:"#e3f2fd",text:"#0d47a1"},{bg:"#fce4ec",text:"#880e4f"},{bg:"#f3e5f5",text:"#4a148c"},{bg:"#e8f5e9",text:"#1b5e20"},{bg:"#fff3e0",text:"#e65100"},{bg:"#e0f2f1",text:"#004d40"},{bg:"#ffebee",text:"#b71c1c"},{bg:"#fff8e1",text:"#f57f17"},{bg:"#eceff1",text:"#37474f"}];let n=0;for(let t=0;t<e.length;t++)n=e.charCodeAt(t)+((n<<5)-n);return t[Math.abs(n)%t.length]}function fallbackCopyTextToClipboard(e,t){const n=document.createElement("textarea");n.value=e,n.style.top="0",n.style.left="0",n.style.position="fixed",n.style.opacity="0",document.body.appendChild(n),n.focus(),n.select();try{document.execCommand("copy")?M.toast({html:t}):M.toast({html:"コピーに失敗しました (execCommand error)"})}catch(e){console.error("Fallback: Oops, unable to copy",e),M.toast({html:"コピーに失敗しました"})}document.body.removeChild(n)}function copyToClip(e,t="コピーしました"){e&&(navigator.clipboard?navigator.clipboard.writeText(e).then(()=>{M.toast({html:t})},n=>{console.warn("Async: Could not copy text: ",n),fallbackCopyTextToClipboard(e,t)}):fallbackCopyTextToClipboard(e,t))}function escapeHtml(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""}function getStorageKey(){let e=window.location.pathname.split("/").pop();return e||(e="default"),"linkManager_"+e}function getBaseFileName(){let e="LinkManager";try{const t=window.location.pathname.split("/").pop();if(t){let n=decodeURIComponent(t);n=n.replace(/\.[^/.]+$/,""),n&&(e=n)}}catch(e){console.error("FileName get error:",e)}return e}function debounce(e,t){let n;return function(...i){const l=this;clearTimeout(n),n=setTimeout(()=>{e.apply(l,i)},t)}}function saveLinks(){localStorage.setItem(getStorageKey(),JSON.stringify(state.links))}let editChipsInstance=null,bulkChipsInstance=null,bulkDeleteChipsInstance=null;function renderLinks(){populateFilterOptions();const e=document.getElementById("linkList");if(e.innerHTML="",0===state.links.length)return e.innerHTML='\n        <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 60px;">\n            <i class="material-icons grey-text" style="font-size: 64px;">dashboard_customize</i>\n            <p class="grey-text">リンクがありません。<br>右下の「+」ボタンからカードを追加してください。</p>\n        </div>\n    ',document.getElementById("bulkActionBar").style.display="none",void(document.getElementById("fabAdd").style.display="block");const t=""!==state.filterTag||""!==state.filterKeyword,n=document.getElementById("filterActiveMsg");state.sortableInstance&&state.sortableInstance.option("disabled",t),n&&(n.style.display=t?"inline-block":"none");let i=0;const l=[];state.links.forEach((e,t)=>{if(!e)return;if(state.filterTag){if(!(e.tags||"").split(/,|、/).map(e=>e.trim()).includes(state.filterTag))return}if(state.filterKeyword){if(!(e.title+" "+e.description+" "+e.remarks+" "+e.tags+" "+e.url).toLowerCase().includes(state.filterKeyword))return}i++;const n=(e.tags||"").split(/,|、/).map(e=>e.trim()).filter(e=>e).map(e=>{const t=highlightText(escapeHtml(e)),n=getTagColor(e);return`<span class="tag-chip tooltipped" style="background-color: ${n.bg}; color: ${n.text};" data-position="top" data-tooltip="絞り込み" onclick="event.stopPropagation(); setFilterTag('${escapeHtml(e)}')">${t}</span>`}).join("");let s="",o="";const a=isWebUrl(e.url);if(a){try{o=new URL(e.url).hostname}catch(e){}const t=o?`https://www.google.com/s2/favicons?domain=${o}`:null;s=t?`<img src="${t}" class="card-favicon" alt="icon">`:'<i class="material-icons grey-text text-lighten-1 card-file-icon">public</i>'}else{const t=getFileIconInfo(e.url);s=`<i class="material-icons card-file-icon ${t.color}">${t.icon}</i>`}const r=highlightText(escapeHtml(e.title||"No Title")),c=highlightText(escapeHtml(e.description)),d=a?"":`<div class="icon-btn tooltipped" data-position="top" data-tooltip="親フォルダ" onclick="event.stopPropagation(); copyFolderByIndex(${t})"><i class="material-icons">folder</i></div>`,p=a?"":`<div class="icon-btn tooltipped" data-position="top" data-tooltip="親フォルダ(Win)" onclick="event.stopPropagation(); copyFolderWindowsByIndex(${t})"><i class="material-icons">desktop_windows</i></div>`,u=`<div class="icon-btn tooltipped" data-position="top" data-tooltip="パス(Win)" onclick="event.stopPropagation(); copyLinkWindowsByIndex(${t})"><i class="material-icons">laptop_windows</i></div>`,g=`\n      <div class="link-card ${e.selected?"selected":""}" onclick="openEditModal(${t})">\n          <div class="card-header">\n              <div class="card-header-main">\n                  <div class="card-check" onclick="event.stopPropagation()">\n                      <label><input type="checkbox" class="filled-in" ${e.selected?"checked":""} onchange="toggleSelect(${t})" /><span></span></label>\n                  </div>\n                  ${s}\n                  <div class="card-title-group">\n                      <div class="card-title" title="${escapeHtml(e.title)}">${r}</div>\n                      ${o?`<div class="card-domain">${o}</div>`:""}\n                  </div>\n              </div>\n              <a class='dropdown-trigger menu-btn' href='#' data-target='dropdown_${t}' onclick="event.stopPropagation()"><i class="material-icons">more_vert</i></a>\n          </div>\n          <div class="card-body">\n              <div class="card-desc">${c||'<span class="grey-text text-lighten-2">概要なし</span>'}</div>\n              <div class="card-tags">${n}</div>\n          </div>\n          <div class="card-footer">\n              <div class="card-actions-left">\n                  <div class="icon-btn tooltipped" data-position="top" data-tooltip="開く" onclick="event.stopPropagation(); openUrlByIndex(${t})"><i class="material-icons">open_in_new</i></div>\n                  <div class="icon-btn tooltipped" data-position="top" data-tooltip="URLコピー" onclick="event.stopPropagation(); copyLinkByIndex(${t})"><i class="material-icons">content_copy</i></div>\n                  ${u} ${d} ${p}\n              </div>\n          </div>\n          <ul id='dropdown_${t}' class='dropdown-content'>\n              <li><a onclick="event.stopPropagation(); duplicateLink(${t})"><i class="material-icons deep-purple-text">control_point_duplicate</i>複製</a></li>\n              <li class="divider" tabindex="-1"></li>\n              <li><a class="menu-delete" onclick="event.stopPropagation(); deleteLinkFromList(${t})"><i class="material-icons">delete</i>削除</a></li>\n          </ul>\n      </div>\n    `;l.push(g)}),e.innerHTML=l.join(""),0===i&&state.links.length>0&&(e.innerHTML='<div class="empty-state" style="grid-column:1/-1;text-align:center;padding:40px;"><i class="material-icons grey-text">search_off</i><p>条件に一致するカードが見つかりませんでした。</p></div>');const s=state.links.filter(e=>e.selected).length,o=document.getElementById("bulkActionBar");s>0?(o.style.display="block",document.getElementById("bulkSelectCount").innerText=`${s} 件選択`):o.style.display="none",updateSelectAllCheckbox(),M.Tooltip.init(e.querySelectorAll(".tooltipped"),{enterDelay:500}),M.Dropdown.init(e.querySelectorAll(".dropdown-trigger"),{constrainWidth:!1,coverTrigger:!1,alignment:"right"})}function getUniqueTags(){const e={};return state.links.forEach(t=>{t.tags&&t.tags.split(/,|、/).map(e=>e.trim()).filter(e=>e).forEach(t=>e[t]=null)}),e}function openEditModal(e){if(e<0||e>=state.links.length)return;setCurrentEditIndex(e);const t=state.links[e];document.getElementById("linkId").value=t.id,document.getElementById("inputTitle").value=t.title,document.getElementById("inputUrl").value=t.url,document.getElementById("inputDesc").value=t.description,document.getElementById("inputRemarks").value=t.remarks;const n=(t.tags||"").split(/,|、/).map(e=>e.trim()).filter(e=>e).map(e=>({tag:e})),i=document.getElementById("tagChips");editChipsInstance&&editChipsInstance.destroy(),editChipsInstance=M.Chips.init(i,{data:n,placeholder:"タグ追加...",secondaryPlaceholder:"+タグ",autocompleteOptions:{data:getUniqueTags(),limit:1/0,minLength:1},onChipAdd:updateLinkValue,onChipDelete:updateLinkValue}),M.updateTextFields(),M.textareaAutoResize(document.getElementById("inputDesc")),M.textareaAutoResize(document.getElementById("inputRemarks"));const l=document.getElementById("linkModal");let s=M.Modal.getInstance(l);s||(s=M.Modal.init(l)),s.open()}function updateLinkValue(){if(-1===state.currentEditIndex)return;let e="";editChipsInstance&&(e=editChipsInstance.chipsData.map(e=>e.tag).join(", ")),state.links[state.currentEditIndex].title=document.getElementById("inputTitle").value,state.links[state.currentEditIndex].url=document.getElementById("inputUrl").value,state.links[state.currentEditIndex].tags=e,state.links[state.currentEditIndex].description=document.getElementById("inputDesc").value,state.links[state.currentEditIndex].remarks=document.getElementById("inputRemarks").value,saveLinks(),renderLinks()}const updateLinkValueDebounced=debounce(()=>{updateLinkValue()},500);function openBulkTagModal(){const e=state.links.filter(e=>e.selected);if(0===e.length)return void M.toast({html:"リンクが選択されていません"});const t=new Set;e.forEach(e=>{e.tags&&e.tags.split(/,|、/).map(e=>e.trim()).filter(e=>e).forEach(e=>t.add(e))});const n=document.getElementById("bulkReferenceTags");n.innerHTML="",t.size>0?Array.from(t).sort().forEach(e=>{const t=document.createElement("span");t.className="ref-tag-chip",t.innerText=e,t.onclick=()=>{bulkChipsInstance&&bulkChipsInstance.addChip({tag:e})},n.appendChild(t)}):n.innerHTML='<span class="grey-text text-lighten-1" style="font-size:0.8rem;">(既存のタグはありません)</span>';const i=document.getElementById("bulkTagChips");bulkChipsInstance&&bulkChipsInstance.destroy(),bulkChipsInstance=M.Chips.init(i,{data:[],placeholder:"追加するタグ...",secondaryPlaceholder:"+タグ",autocompleteOptions:{data:getUniqueTags(),limit:1/0,minLength:1}}),M.Modal.getInstance(document.getElementById("bulkTagModal")).open()}function openBulkTagDeleteModal(){const e=state.links.filter(e=>e.selected);if(0===e.length)return void M.toast({html:"リンクが選択されていません"});const t=new Set;e.forEach(e=>{e.tags&&e.tags.split(/,|、/).map(e=>e.trim()).filter(e=>e).forEach(e=>t.add(e))});const n=document.getElementById("bulkDeleteReferenceTags");n.innerHTML="",t.size>0?Array.from(t).sort().forEach(e=>{const t=document.createElement("span");t.className="ref-tag-chip",t.innerText=e,t.onclick=()=>{bulkDeleteChipsInstance&&bulkDeleteChipsInstance.addChip({tag:e})},n.appendChild(t)}):n.innerHTML='<span class="grey-text text-lighten-1" style="font-size:0.8rem;">(削除できるタグがありません)</span>';const i=document.getElementById("bulkTagDeleteChips");bulkDeleteChipsInstance&&bulkDeleteChipsInstance.destroy(),bulkDeleteChipsInstance=M.Chips.init(i,{data:[],placeholder:"削除するタグ...",secondaryPlaceholder:"+タグ",autocompleteOptions:{data:getUniqueTags(),limit:1/0,minLength:1}}),M.Modal.getInstance(document.getElementById("bulkTagDeleteModal")).open()}function populateFilterOptions(){const e=document.getElementById("filterTag"),t=e.value;for(;e.options.length>1;)e.remove(1);const n=new Set;state.links.forEach(e=>{e.tags&&e.tags.split(/,|、/).map(e=>e.trim()).filter(e=>e).forEach(e=>n.add(e))}),Array.from(n).sort().forEach(t=>{const n=document.createElement("option");n.value=t,n.text=t,e.add(n)}),e.value=t,M.FormSelect.init(e)}function applyFilter(){setFilter(document.getElementById("filterTag").value,document.getElementById("searchInput").value.toLowerCase()),renderLinks()}function setFilterTag(e){const t=document.getElementById("filterTag");t.value=e,M.FormSelect.init(t),applyFilter(),M.toast({html:`タグ「${e}」で絞り込みました`,displayLength:2e3})}function clearFilter(){document.getElementById("filterTag").value="",document.getElementById("searchInput").value="",setFilter("",""),M.FormSelect.init(document.querySelectorAll("select")),renderLinks()}function toggleSelect(e){state.links[e]&&(state.links[e].selected=!state.links[e].selected,saveLinks(),renderLinks())}function toggleSelectAll(e){state.links.forEach(t=>{let n=!0;if(state.filterTag){(t.tags||"").split(/,|、/).map(e=>e.trim()).includes(state.filterTag)||(n=!1)}if(n&&state.filterKeyword){(t.title+" "+t.description+" "+t.remarks+" "+t.tags+" "+t.url).toLowerCase().includes(state.filterKeyword)||(n=!1)}n&&(t.selected=e)}),saveLinks(),renderLinks()}function updateSelectAllCheckbox(){const e=document.getElementById("selectAllLinks");if(!e)return;const t=state.links.filter(e=>{if(state.filterTag){if(!(e.tags||"").split(/,|、/).map(e=>e.trim()).includes(state.filterTag))return!1}if(state.filterKeyword){if(!(e.title+" "+e.description+" "+e.remarks+" "+e.tags+" "+e.url).toLowerCase().includes(state.filterKeyword))return!1}return!0});0===t.length?(e.checked=!1,e.disabled=!0):(e.disabled=!1,e.checked=t.every(e=>e.selected))}function createNewLink(){if(state.filterTag||state.filterKeyword){if(!confirm("フィルターを解除して新規作成しますか？"))return;clearFilter()}const e={id:Date.now(),title:"",url:"",tags:"",description:"",remarks:""};state.links.unshift(e),saveLinks(),renderLinks(),openEditModal(0)}function highlightRow(e){const t=document.querySelectorAll("#linkList .link-card");t[e]&&(t[e].scrollIntoView({behavior:"smooth",block:"center"}),t[e].style.transition="transform 0.3s, box-shadow 0.3s, background-color 0.5s",t[e].style.backgroundColor="#fff9c4",setTimeout(()=>{t[e].style.backgroundColor=""},1500))}function getBulkChipsData(){return bulkChipsInstance?bulkChipsInstance.chipsData.map(e=>e.tag):[]}function getBulkDeleteChipsData(){return bulkDeleteChipsInstance?bulkDeleteChipsInstance.chipsData.map(e=>e.tag):[]}function clearSelection(){state.links.forEach(e=>e.selected=!1),saveLinks(),renderLinks(),M.toast({html:"選択を解除しました",displayLength:1e3})}function executeDelete(e){if(confirm("このリンクを削除しますか？")){setDeletedLink(state.links[e],e),state.links.splice(e,1),setCurrentEditIndex(-1),saveLinks(),renderLinks();const t='<span>削除しました</span><button class="toast-action-btn" onclick="undoDelete()">元に戻す</button>';M.toast({html:t,displayLength:5e3})}}function deleteLinkFromList(e){executeDelete(e)}function deleteLinkInModal(){-1!==state.currentEditIndex&&(M.Modal.getInstance(document.getElementById("linkModal")).close(),executeDelete(state.currentEditIndex))}function undoDelete(){state.deletedLink&&(state.deletedLinkIndex>=0&&state.deletedLinkIndex<=state.links.length?state.links.splice(state.deletedLinkIndex,0,state.deletedLink):state.links.push(state.deletedLink),saveLinks(),renderLinks(),setTimeout(()=>highlightRow(state.deletedLinkIndex),100),M.toast({html:"元に戻しました"}),setDeletedLink(null,-1),M.Toast.dismissAll())}function duplicateLink(e){const t=state.links[e],n=JSON.parse(JSON.stringify(t));n.id=Date.now(),n.title=n.title+" (コピー)",state.links.splice(e+1,0,n),saveLinks(),renderLinks(),openEditModal(e+1),M.toast({html:"複製しました"})}function resetToSaved(){confirm("現在の編集内容を破棄して、ファイル保存時の状態に戻しますか？")&&(window.savedData&&Array.isArray(window.savedData)&&window.savedData.length>0?setLinks(JSON.parse(JSON.stringify(window.savedData))):setLinks([]),saveLinks(),renderLinks(),M.toast({html:"保存時の状態に戻しました"}))}function resetCurrentLink(){if(-1===state.currentEditIndex)return;if(!confirm("このリンクの内容をファイル保存時の状態に戻しますか？"))return;const e=state.links[state.currentEditIndex].id;let t=null;window.savedData&&Array.isArray(window.savedData)&&(t=window.savedData.find(t=>t.id===e)),t?(state.links[state.currentEditIndex]=JSON.parse(JSON.stringify(t)),M.toast({html:"復元しました"})):(state.links[state.currentEditIndex]={id:e,title:"",url:"",tags:"",description:"",remarks:""},M.toast({html:"初期状態（空）に戻しました"})),openEditModal(state.currentEditIndex),saveLinks(),renderLinks()}function bulkDelete(){const e=state.links.filter(e=>e.selected);0!==e.length&&confirm(`選択された ${e.length}件のリンクを削除しますか？`)&&(setLinks(state.links.filter(e=>!e.selected)),saveLinks(),renderLinks(),M.toast({html:"一括削除しました"}))}function applyBulkTags(){const e=getBulkChipsData(),t=state.links.filter(e=>e.selected);if(0===t.length)return;if(0===e.length)return void M.toast({html:"追加するタグを入力してください"});const n=e.join(", ");confirm(`選択された ${t.length}件にタグ「${n}」を追加しますか？`)&&(t.forEach(t=>{const n=(t.tags||"").split(/,|、/).map(e=>e.trim()).filter(e=>e);e.forEach(e=>{n.includes(e)||n.push(e)}),t.tags=n.join(", "),t.selected=!1}),saveLinks(),renderLinks(),M.toast({html:"タグを追加しました"}))}function applyBulkTagDelete(){const e=getBulkDeleteChipsData(),t=state.links.filter(e=>e.selected);if(0===t.length)return;if(0===e.length)return void M.toast({html:"削除するタグを入力してください"});const n=e.join(", ");confirm(`選択された ${t.length}件からタグ「${n}」を削除しますか？`)&&(t.forEach(t=>{let n=(t.tags||"").split(/,|、/).map(e=>e.trim()).filter(e=>e);n=n.filter(t=>!e.includes(t)),t.tags=n.join(", "),t.selected=!1}),saveLinks(),renderLinks(),M.toast({html:"タグを削除しました"}))}function bulkCopyUrls(){}function copyLinkSmart(e){if(!e)return M.toast({html:"リンクがありません",classes:"red"});let t=String(e);!isWebUrl(e)&&t.includes(" ")&&(t=`"${t}"`),copyToClip(t)}function copyLinkWindows(e){if(!e)return M.toast({html:"リンクがありません",classes:"red"});copyToClip(`explorer "${e}"`,"Windows用コマンドをコピーしました")}function openCurrentUrl(){const e=document.getElementById("inputUrl").value;e&&window.open(e,"_blank")}function copyLinkByIndex(e){state.links[e]&&copyLinkSmart(state.links[e].url)}function copyLinkWindowsByIndex(e){state.links[e]&&copyLinkWindows(state.links[e].url)}function openUrlByIndex(e){state.links[e]&&window.open(state.links[e].url,"_blank")}function exportJSON(){if(0===state.links.length)return M.toast({html:"データがありません"});const e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(state.links,null,2)),t=document.createElement("a");t.href=e;const n=(new Date).toISOString().slice(0,19).replace(/[-:]/g,"").replace("T","_");t.download=`${getBaseFileName()}_${n}.json`,document.body.appendChild(t),t.click(),t.remove(),M.toast({html:"JSONファイルを保存しました"})}function importJSON(e){const t=e.files[0];if(!t)return;const n=new FileReader;n.onload=function(t){try{const e=JSON.parse(t.target.result);Array.isArray(e)?(setPendingJsonImport(e),document.getElementById("importCount").innerText=e.length,M.Modal.getInstance(document.getElementById("importChoiceModal")).open()):M.toast({html:"JSONフォーマットが正しくありません"})}catch(e){console.error(e),M.toast({html:"読込失敗"})}e.value=""},n.readAsText(t)}function resolveImport(e){if("cancel"===e)return setPendingJsonImport(null);if(!state.pendingJsonImport)return;const t=state.pendingJsonImport.map(e=>({...e,id:Date.now()+Math.random(),title:e.title||"No Title",url:e.url||"",tags:e.tags||"",description:e.description||"",remarks:e.remarks||""}));"replace"===e?(setLinks(t),M.toast({html:"データを置き換えました"})):"append"===e&&(setLinks([...state.links,...t]),M.toast({html:`${t.length}件追加しました`})),saveLinks(),renderLinks(),setPendingJsonImport(null)}function exportHTML(){const e=document.documentElement.cloneNode(!0);e.querySelectorAll(".sidenav-overlay, .drag-target, .toast, .material-tooltip, .hiddendiv").forEach(e=>e.remove()),e.querySelectorAll(".dropdown-content").forEach(e=>{e.removeAttribute("style"),e.classList.remove("active")}),e.querySelectorAll(".select-wrapper").forEach(e=>{const t=e.querySelector("select");t&&(t.removeAttribute("tabindex"),t.classList.remove("initialized"),Array.from(t.options).forEach(e=>e.removeAttribute("selected")),e.parentNode.replaceChild(t,e))}),e.querySelectorAll("label.active").forEach(e=>e.classList.remove("active")),e.querySelectorAll("input, textarea").forEach(e=>{e.classList.remove("valid","invalid"),"TEXTAREA"===e.tagName?e.innerHTML="":e.setAttribute("value","")});const t=e.querySelector("#linkList");t&&(t.innerHTML="",t.removeAttribute("style"));const n=e.querySelector("#filterTag");n&&(n.value="");const i=e.querySelector("#searchInput");i&&i.setAttribute("value",""),e.querySelectorAll(".chips").forEach(e=>e.innerHTML="");const l=e.querySelector("#initial-state"),s=`window.savedData = ${JSON.stringify(state.links||[]).replace(/<\/script>/g,"<\\/script>")};`;if(l)l.textContent=s;else{console.warn("State script tag not found in clone. Creating one.");const t=document.createElement("script");t.id="initial-state",t.textContent=s,e.querySelector("body").appendChild(t)}const o=e.outerHTML,a=new Blob(["<!doctype html>"+o],{type:"text/html"}),r=URL.createObjectURL(a),c=document.createElement("a");c.href=r;const d=(new Date).toISOString().slice(0,19).replace(/[-:]/g,"").replace("T","_");c.download=`${getBaseFileName()}_${d}.html`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(r),M.toast({html:"保存しました"})}function getParentPath(e){if(!e)return"";let t=String(e);t=t.replace(/([/\\]|[¥￥])+$/,"");const n=t.lastIndexOf("/"),i=t.lastIndexOf("\\"),l=t.lastIndexOf("¥"),s=t.lastIndexOf("￥"),o=Math.max(n,i,l,s);if(o<0)return t;if(0===o)return t.substring(0,1);let a=t.substring(0,o);return/^[a-zA-Z]:$/.test(a)?a+t.charAt(o):a}function quotePathIfSpace(e){return e?e.includes(" ")&&!e.startsWith('"')?`"${e}"`:e:""}function copyFolderByIndex(e){const t=state.links[e];if(!t||!t.url)return;copyToClip(quotePathIfSpace(getParentPath(t.url)),"親フォルダのパスをコピーしました")}function copyFolderWindowsByIndex(e){const t=state.links[e];if(!t||!t.url)return;copyToClip(`explorer "${getParentPath(t.url)}"`,"親フォルダ用コマンドをコピーしました")}const Actions=Object.freeze(Object.defineProperty({__proto__:null,applyBulkTagDelete:applyBulkTagDelete,applyBulkTags:applyBulkTags,bulkCopyUrls:bulkCopyUrls,bulkDelete:bulkDelete,clearSelection:clearSelection,copyFolderByIndex:copyFolderByIndex,copyFolderWindowsByIndex:copyFolderWindowsByIndex,copyLinkByIndex:copyLinkByIndex,copyLinkSmart:copyLinkSmart,copyLinkWindows:copyLinkWindows,copyLinkWindowsByIndex:copyLinkWindowsByIndex,deleteLinkFromList:deleteLinkFromList,deleteLinkInModal:deleteLinkInModal,duplicateLink:duplicateLink,executeDelete:executeDelete,exportHTML:exportHTML,exportJSON:exportJSON,importJSON:importJSON,openCurrentUrl:openCurrentUrl,openUrlByIndex:openUrlByIndex,resetCurrentLink:resetCurrentLink,resetToSaved:resetToSaved,resolveImport:resolveImport,undoDelete:undoDelete},Symbol.toStringTag,{value:"Module"})),logs=[{version:"2.0.2",desc:"Windows用パス操作ボタン（パス・親フォルダコピー）をOSに関わらず常に表示するように変更。クリップボードコピー処理の互換性向上（動作しない環境への対策）、および親フォルダパス取得ロジックの修正。"},{version:"2.0.1",desc:"「Save Tool」で保存したHTMLファイルを開いた際に、データが正しく読み込まれない（空になる）不具合を修正。"},{version:"2.0.0",desc:"UIデザインを刷新し、カード型グリッドレイアウトへ変更。タグの一括追加・削除機能、全選択/解除機能、検索バーのスクロール追従、ローカルファイルのアイコン表示およびパスコピー機能の強化、ヘルプのファイル分割など、操作性と視認性を大幅に向上。"},{version:"1.21.0",desc:"開発環境の刷新（Vite導入によるファイルの分割管理・ビルド構成の変更）。"},{version:"1.20.0",desc:"JSONおよびExcelの読込機能が動作しない（ファイル選択ダイアログが開かない）不具合を修正。"},{version:"1.19.0",desc:"検索入力欄のレイアウトを改善（可変幅にし、入力を広く行えるように変更）。"},{version:"1.18.0",desc:"大量管理機能を強化（固定ヘッダー、チェックボックスによる一括削除・タグ変更・URLコピー、入力候補の動的更新）。"},{version:"1.17.0",desc:"マルチプロジェクト対応（ファイル名によるデータ分離）と、入力処理の軽量化(Debounce)を実施。"},{version:"1.16.0",desc:"ビルドシステムの導入によるファイルの軽量化(Minify)と、内部コードの最適化を実施。"},{version:"1.15.0",desc:"Windows用コマンド（explorer付き）での「リンクコピー」「親フォルダコピー」ボタンを一覧画面に追加。"},{version:"1.14.0",desc:"「リンクをコピー」「親フォルダをコピー」ボタンを操作メニューから一覧行に移動し、直接操作できるように改善。"},{version:"1.13.0",desc:"バックスラッシュを含むパスが正しくコピーされない不具合を修正。"},{version:"1.12.0",desc:"JSON形式でのエクスポート、インポート（追加/置換選択）機能を追加。"},{version:"1.11.0",desc:"タグの自動色分け機能、削除時のUndo（元に戻す）機能、データ空時の表示を追加。"},{version:"1.10.0",desc:"検索ハイライト、マテリアルツールチップ、操作メニューの整理（複製/削除/コピーをメニュー化）。"},{version:"1.9.0",desc:"タグ表示エリアを拡張し、最大3行まで表示できるようにレイアウト調整。"},{version:"1.8.0",desc:"編集時のハイライト機能を追加。"},{version:"1.7.0",desc:"リンクの複製（コピー）機能を追加。"},{version:"1.6.0",desc:"リスト内のタグクリックによる絞り込み機能を追加。"},{version:"1.5.0",desc:"リンクのクリック可能範囲をタイトル・アイコン・URLを含むブロック全体に拡大。"},{version:"1.4.0",desc:"親フォルダコピー機能とパスの引用符処理を、ローカルパス（Mac/Win）のみに限定するよう改良。"},{version:"1.3.0",desc:"ファビコン表示、タイトルからの直接リンク移動、タグ入力補助機能を追加。"},{version:"1.2.0",desc:"スペースを含むパスの引用符対応、フォルダパスのコピー機能追加。"},{version:"1.1.0",desc:"編集画面が開かない不具合を修正。"},{version:"1.0.0",desc:"初版リリース（基本機能、Excel連携、HTML保存機能など）。"}];function renderChangeLog(){const e=document.getElementById("changelogList");e&&(e.innerHTML=logs.map(e=>`\n          <li class="collection-item">\n              <span class="changelog-date" style="font-weight:bold; color:var(--md-sys-color-primary); margin-right:8px;">v${e.version}</span>\n              <span>${e.desc}</span>\n          </li>\n      `).join(""))}function renderHelp(){const e=document.getElementById("help");if(!e)return;e.innerHTML='\n    <h6><i class="material-icons tiny">touch_app</i> 基本操作</h6>\n    <ul class="browser-default" style="padding-left: 20px; font-size: 0.9rem;">\n        <li><b>新規作成:</b> 右下の「+」ボタンをクリックします。</li>\n        <li><b>編集:</b> カードをクリックすると詳細画面が開きます。</li>\n        <li><b>リンクを開く:</b> カード左下の <i class="material-icons tiny">open_in_new</i> アイコンをクリックします。</li>\n        <li><b>検索:</b> 画面上部のバーでキーワード検索やタグ絞り込みができます。</li>\n    </ul>\n\n    <h6><i class="material-icons tiny">check_box</i> 一括操作</h6>\n    <p style="font-size: 0.9rem;">カード左上のチェックボックスを選択すると、画面下部に操作バーが表示されます。</p>\n    <ul class="browser-default" style="padding-left: 20px; font-size: 0.9rem;">\n        <li><b>タグ追加:</b> 選択したリンクにタグをまとめて追加します（既存タグは維持）。</li>\n        <li><b>タグ削除:</b> 選択したリンクから特定のタグをまとめて削除します。</li>\n        <li><b>削除:</b> 選択したリンクを一括削除します。</li>\n        <li><b>全選択:</b> 検索バーの「全選択」チェックで、現在表示されているリンクを全て選択できます。</li>\n    </ul>\n\n    <h6><i class="material-icons tiny">laptop_windows</i> ローカルファイル連携</h6>\n    <p style="font-size: 0.9rem;">ローカルファイルのパス（例: <code>C:\\Work\\file.xlsx</code>）を登録した場合：</p>\n    <ul class="browser-default" style="padding-left: 20px; font-size: 0.9rem;">\n        <li>拡張子に応じてアイコンが変化します。</li>\n        <li><i class="material-icons tiny">folder</i> アイコンで、そのファイルがある「親フォルダ」のパスをコピーできます。</li>\n        <li>(Windowsのみ) <i class="material-icons tiny">laptop_windows</i> アイコンで、エクスプローラーで開くためのパスをコピーできます。</li>\n    </ul>\n\n    <h6><i class="material-icons tiny">save</i> データ保存・管理</h6>\n    <ul class="browser-default" style="padding-left: 20px; font-size: 0.9rem;">\n        <li><b>ツール保存:</b> 「Save Tool」をクリックすると、現在のデータを含んだHTMLファイルとしてダウンロードされます。</li>\n        <li><b>プロジェクト管理:</b> ダウンロードしたHTMLのファイル名を変更することで、別々のプロジェクトとしてデータを管理できます。</li>\n        <li><b>JSON連携:</b> データのバックアップや移行用に、JSON形式での入出力が可能です。</li>\n    </ul>\n  '}const globals={renderLinks:renderLinks,toggleSelect:toggleSelect,toggleSelectAll:toggleSelectAll,updateLinkValueDebounced:updateLinkValueDebounced,createNewLink:createNewLink,openEditModal:openEditModal,setFilterTag:setFilterTag,clearFilter:clearFilter,applyFilter:applyFilter,openBulkTagModal:openBulkTagModal,openBulkTagDeleteModal:openBulkTagDeleteModal,...Actions};function loadLinks(){try{let e=null;if(window.savedData&&Array.isArray(window.savedData)&&(e=window.savedData),!e){const t=document.getElementById("initial-state");if(t&&t.textContent)try{const n=t.textContent.trim().match(/window\.savedData\s*=\s*(\[.*\]);?/s);n&&n[1]&&(e=JSON.parse(n[1]),console.log("Recovered data from script tag content."))}catch(e){console.warn("Failed to parse initial-state tag directly:",e)}}if(e&&Array.isArray(e)&&e.length>0){setLinks(JSON.parse(JSON.stringify(e)));try{saveLinks()}catch(e){console.warn("LocalStorage sync failed (non-fatal):",e)}}else{const e=localStorage.getItem(getStorageKey());setLinks(e?JSON.parse(e):[{id:Date.now(),title:"Google",url:"https://www.google.com",tags:"検索, ツール",description:"世界最大の検索エンジン",remarks:""}])}}catch(e){console.error("Critical Load Error:",e),setLinks([])}renderLinks()}Object.keys(globals).forEach(e=>{window[e]=globals[e]}),document.addEventListener("DOMContentLoaded",function(){M.Modal.init(document.querySelectorAll(".modal"),{onCloseEnd:function(e){"linkModal"===e.id&&-1!==state.currentEditIndex&&highlightRow(state.currentEditIndex)}}),M.FormSelect.init(document.querySelectorAll("select")),M.Sidenav.init(document.querySelectorAll(".sidenav")),M.Tabs.init(document.querySelectorAll(".tabs")),M.Tooltip.init(document.querySelectorAll(".tooltipped")),M.Dropdown.init(document.querySelectorAll(".dropdown-trigger"),{constrainWidth:!1,coverTrigger:!1,alignment:"right"}),loadLinks(),renderChangeLog(),renderHelp();const e=document.getElementById("linkList");state.sortableInstance=Sortable.create(e,{animation:150,ghostClass:"sortable-ghost",delay:0,touchStartThreshold:3,onEnd:function(e){const t=state.links.splice(e.oldIndex,1)[0];state.links.splice(e.newIndex,0,t),saveLinks(),renderLinks()}})})</script><style rel="stylesheet" crossorigin>:root{--color-primary:#6366f1;--color-primary-bg:#eef2ff;--color-surface:#ffffff;--color-background:#f8fafc;--color-text-main:#1e293b;--color-text-sub:#64748b;--color-border:#e2e8f0;--radius-md:12px;--radius-lg:20px;--radius-pill:9999px;--shadow-sm:0 1px 2px 0 rgba(0, 0, 0, 0.05);--shadow-md:0 4px 6px -1px rgba(0, 0, 0, 0.1);--shadow-float:0 20px 25px -5px rgba(0, 0, 0, 0.1),0 10px 10px -5px rgba(0, 0, 0, 0.04)}body{background-color:var(--color-background);color:var(--color-text-main);font-family:Inter,"Noto Sans JP",sans-serif;padding-bottom:120px;line-height:1.6}nav{background-color:rgba(255,255,255,.8)!important;backdrop-filter:blur(12px);border-bottom:1px solid var(--color-border);box-shadow:none!important;height:64px;position:sticky;top:0;z-index:1000}nav .brand-logo{color:var(--color-text-main)!important;font-weight:700;font-size:1.25rem;display:flex;align-items:center;white-space:nowrap}nav .brand-logo i{color:var(--color-primary);margin-right:8px}nav ul a{color:var(--color-text-sub)!important;font-weight:500}nav ul a:hover{color:var(--color-primary)!important;background-color:transparent!important}nav .sidenav-trigger{margin:0}nav .sidenav-trigger i{color:var(--color-text-main)!important;font-size:24px}.sidenav{z-index:9999!important}.sidenav-overlay{z-index:9998!important}.sticky-header-wrapper{position:sticky;top:80px;margin:24px auto 32px;max-width:900px;width:92%;z-index:900;pointer-events:none}.filter-area{background-color:var(--color-surface);border-radius:var(--radius-pill);padding:4px 16px;display:flex;align-items:center;gap:8px;box-shadow:var(--shadow-md);border:1px solid var(--color-border);pointer-events:auto;height:56px;transition:all .3s ease;overflow:hidden}.filter-area:focus-within{box-shadow:0 10px 15px -3px rgba(0,0,0,.1);border-color:var(--color-primary);transform:translateY(-1px)}.filter-area i.prefix{color:var(--color-text-sub);display:flex;align-items:center;flex-shrink:0}.filter-search{flex:1;min-width:100px;display:flex;align-items:center}.filter-area input[type=text]{border:none!important;box-shadow:none!important;margin:0!important;height:100%!important;padding:0!important;font-size:1rem;color:var(--color-text-main);width:100%}.filter-area input::placeholder{color:#94a3b8;text-overflow:ellipsis}.input-field{margin:0;flex-shrink:0;max-width:140px}.select-wrapper input.select-dropdown{border-bottom:none!important;color:var(--color-text-sub);font-size:.9rem;font-weight:500;text-align:center!important;padding-right:20px!important;margin:0;height:100%;box-sizing:border-box;text-overflow:ellipsis}.select-wrapper .caret{right:0;z-index:1}.select-all-container{border-left:1px solid #e2e8f0;padding-left:12px;margin-left:4px;height:32px;display:flex;align-items:center;flex-shrink:0}.select-all-container label{display:flex;align-items:center;white-space:nowrap}.select-all-container span{padding-left:24px;color:var(--color-text-sub);font-weight:500}.filter-area .btn-flat{color:var(--color-primary);font-weight:600;padding:0 8px;white-space:nowrap;flex-shrink:0}.autocomplete-content,.dropdown-content{z-index:10000!important;max-height:300px}.container{max-width:1200px!important;width:92%!important}#linkList{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:20px;padding:4px}.link-card{background-color:var(--color-surface);border-radius:var(--radius-lg);padding:20px;box-shadow:var(--shadow-sm);border:1px solid var(--color-border);display:flex;flex-direction:column;position:relative;height:100%;transition:all .2s ease;cursor:pointer}.link-card:hover{transform:translateY(-4px);box-shadow:0 10px 15px -3px rgba(0,0,0,.1);border-color:var(--color-primary-bg)}.link-card.selected{background-color:var(--color-primary-bg);border-color:var(--color-primary);box-shadow:0 0 0 1px var(--color-primary) inset}.card-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}.card-header-main{display:flex;align-items:flex-start;gap:12px;overflow:hidden;flex:1}.card-favicon,.card-file-icon{width:32px;height:32px;border-radius:8px;object-fit:contain;flex-shrink:0;background-color:#f1f5f9;padding:4px}.card-file-icon{display:flex;align-items:center;justify-content:center;font-size:20px}.card-title-group{display:flex;flex-direction:column;overflow:hidden;justify-content:center;min-height:32px}.card-title{font-weight:700;font-size:1rem;color:var(--color-text-main);line-height:1.3;margin-bottom:2px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}.card-domain{font-size:.75rem;color:var(--color-text-sub)}.menu-btn{color:var(--color-text-sub);padding:4px;border-radius:50%;transition:background .2s;margin-top:-4px;margin-right:-8px}.menu-btn:hover{background-color:#f1f5f9;color:var(--color-text-main)}.card-body{flex:1;margin-bottom:16px}.card-desc{font-size:.875rem;color:var(--color-text-sub);display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;overflow:hidden;margin-bottom:12px}.card-tags{display:flex;flex-wrap:wrap;gap:6px}.tag-chip{font-size:.7rem;padding:3px 10px;border-radius:var(--radius-pill);font-weight:600;letter-spacing:.02em;border:1px solid transparent}.card-footer{display:flex;justify-content:space-between;align-items:center;border-top:1px solid var(--color-border);padding-top:12px;margin-top:auto}.card-actions-left{display:flex;gap:8px}.icon-btn{width:36px;height:36px;border-radius:50%;color:var(--color-text-sub);display:flex;align-items:center;justify-content:center;transition:all .2s;border:1px solid transparent}.icon-btn:hover{background-color:#f1f5f9;color:var(--color-primary);border-color:#e2e8f0}.icon-btn i{font-size:1.25rem}.card-check{margin-right:0}.filled-in[type=checkbox]+span:not(.lever):before{border:2px solid #cbd5e1}.filled-in[type=checkbox]:checked+span:not(.lever):after{background-color:var(--color-primary);border:2px solid var(--color-primary);width:20px;height:20px}.modal{border-radius:24px;box-shadow:var(--shadow-float);max-height:90%;outline:0}.modal .modal-content{padding:32px}.modal-footer{background-color:#f8fafc;border-top:1px solid var(--color-border);padding:16px 32px}.modal-header-actions{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--color-border);padding-bottom:16px;margin-bottom:24px;margin-top:-8px}.modal h5{margin:0;font-weight:700;color:var(--color-text-main)}.modal-content .row .input-field{max-width:100%;margin-bottom:20px;position:relative}.modal-content .input-field .prefix{font-size:1.5rem;top:.5rem;width:3rem;text-align:center;color:var(--color-text-sub)}.modal-content .input-field input,.modal-content .input-field textarea{padding-left:3.5rem!important;width:calc(100% - 3.5rem)!important;box-sizing:content-box;margin-left:0!important}.modal-content .input-field label{margin-left:3.5rem!important;width:auto!important}.tag-section{position:relative;padding-left:0;margin-top:1rem;margin-bottom:2rem}.tag-section .prefix{position:absolute;left:0;top:0;font-size:1.5rem;width:3rem;text-align:center;color:var(--color-text-sub)}.tag-section-body{margin-left:3.5rem}.tag-label{display:block;font-size:.8rem;color:#9e9e9e;margin-bottom:8px}#bulkTagDeleteModal,#bulkTagDeleteModal .modal-content,#bulkTagModal,#bulkTagModal .modal-content{overflow:visible!important}.chips{border-bottom:1px solid #9e9e9e;margin-bottom:20px;min-height:45px}.chips.focus{border-bottom:1px solid var(--color-primary);box-shadow:0 1px 0 0 var(--color-primary)}.chips .chip{background-color:var(--color-primary-bg);color:var(--color-primary);font-weight:500}.chips .input{color:var(--color-text-main)!important;font-weight:400}.ref-tag-chip{display:inline-block;padding:2px 8px;background-color:#f1f5f9;color:var(--color-text-main);border-radius:4px;font-size:.75rem;cursor:pointer;border:1px solid #e2e8f0;transition:background .2s}.ref-tag-chip:hover{background-color:#e2e8f0;border-color:#cbd5e1}.bulk-action-bar{position:fixed;bottom:32px;left:50%;transform:translateX(-50%);background-color:#1e293b;color:#fff;border-radius:var(--radius-pill);padding:12px 24px;width:auto;min-width:300px;max-width:95%;box-shadow:var(--shadow-float);z-index:2000;display:none;animation:slideUp .3s cubic-bezier(.16,1,.3,1)}@keyframes slideUp{from{transform:translate(-50%,20px);opacity:0}to{transform:translate(-50%,0);opacity:1}}.bulk-content{display:flex;align-items:center;justify-content:center;gap:24px;flex-wrap:wrap}.bulk-actions-group{display:flex;gap:12px;flex-wrap:nowrap}.bulk-actions-group a{color:#e2e8f0;font-weight:600;font-size:.9rem;cursor:pointer;display:flex;align-items:center;gap:6px;transition:color .2s;white-space:nowrap}.bulk-actions-group a:hover{color:#fff}.fixed-action-btn .btn-large{background-color:var(--color-primary)!important;border-radius:18px;box-shadow:var(--shadow-float)}.search-highlight{background-color:#fef08a;color:#854d0e;padding:0 2px;border-radius:2px;font-weight:600}.empty-state i{color:#cbd5e1}.list-header{display:none}@media only screen and (max-width:600px){nav .brand-logo{font-size:1.1rem}nav .brand-logo i{margin-right:4px}nav .sidenav-trigger{display:block!important;float:right;margin-right:0}#linkList{grid-template-columns:1fr}.sticky-header-wrapper{width:100%;top:70px;margin-top:16px;margin-bottom:24px}.filter-area{height:auto;padding:8px 16px;flex-wrap:wrap;gap:8px;border-radius:16px}.filter-search{flex-basis:100%;order:1;margin-bottom:4px}.input-field{order:2;flex:1;max-width:none}.select-all-container{order:3;border-left:none;padding-left:0;margin-left:8px}.filter-area .btn-flat{order:4;font-size:.8rem;padding:0 4px}#filterActiveMsg{display:none!important}.bulk-action-bar{width:94%;bottom:16px;padding:10px 16px;border-radius:16px}.bulk-content{justify-content:space-between;gap:8px}#bulkSelectCount{font-size:.9rem;margin-right:0}.bulk-actions-group a{font-size:0;gap:0;padding:8px}.bulk-actions-group a i{font-size:1.5rem;margin:0}}</style></head><body><nav><div class="nav-wrapper"><a href="#" class="brand-logo truncate"><i class="material-icons">link</i>Link Manager v2.0.2</a><ul id="nav-mobile" class="right hide-on-med-and-down"><li><a class="modal-trigger" href="#infoModal"><i class="material-icons left">help_outline</i>Help</a></li><li><a onclick="exportHTML()"><i class="material-icons left">save</i>Save Tool</a></li><li><a class="dropdown-trigger" href="#" data-target="dropdown-json"><i class="material-icons left">code</i>JSON</a></li><li><a onclick="resetToSaved()"><i class="material-icons left">restore</i>Reset</a></li></ul><ul id="dropdown-json" class="dropdown-content"><li><a onclick="exportJSON()"><i class="material-icons">file_download</i>JSON保存</a></li><li><a onclick='document.getElementById("jsonInput").click()'><i class="material-icons">file_upload</i>JSON読込</a></li></ul><a href="#" data-target="mobile-demo" class="sidenav-trigger right"><i class="material-icons">menu</i></a></div></nav><ul class="sidenav" id="mobile-demo"><li><a class="modal-trigger" href="#infoModal"><i class="material-icons">help_outline</i>使い方・履歴</a></li><li><a onclick="exportHTML()"><i class="material-icons">save</i>ツール保存</a></li><li class="divider"></li><li><a onclick="exportJSON()"><i class="material-icons">file_download</i>JSON保存</a></li><li><a onclick='document.getElementById("jsonInput").click()'><i class="material-icons">file_upload</i>JSON読込</a></li><li class="divider"></li><li><a onclick="resetToSaved()"><i class="material-icons">restore</i>初期化</a></li></ul><input type="file" id="jsonInput" style="display:none" accept=".json" onchange="importJSON(this)"><div class="container"><div id="stickyHeaderContainer" class="sticky-header-wrapper"><div class="filter-area"><i class="material-icons prefix">search</i><div class="filter-search"><input id="searchInput" type="text" oninput="applyFilter()" placeholder="キーワード検索 (タイトル, URL, タグ...)"></div><div class="input-field"><select id="filterTag" onchange="applyFilter()"><option value="" selected="selected">全てのタグ</option></select></div><div class="select-all-container"><label><input type="checkbox" class="filled-in" id="selectAllLinks" onchange="toggleSelectAll(this.checked)"> <span style="padding-left:24px;color:var(--color-text-sub);font-weight:500">全選択</span></label></div><a class="btn-flat waves-effect waves-teal btn-small" onclick="clearFilter()" style="margin-left:8px">条件クリア</a> <span id="filterActiveMsg" class="filter-msg"><i class="material-icons tiny">info</i> 絞り込み中</span></div></div><div id="linkList"></div></div><div class="fixed-action-btn" id="fabAdd"><a class="btn-floating btn-large tooltipped" data-position="left" data-tooltip="新規リンク作成" onclick="createNewLink()"><i class="large material-icons">add</i></a></div><div id="bulkActionBar" class="bulk-action-bar"><div class="bulk-content"><span id="bulkSelectCount" style="font-weight:700;font-size:1.1rem;margin-right:15px">0 件選択</span><div class="bulk-actions-group"><a class="btn-flat white-text" onclick="openBulkTagModal()"><i class="material-icons left">label</i>タグ追加</a> <a class="btn-flat white-text" onclick="openBulkTagDeleteModal()"><i class="material-icons left">label_off</i>タグ削除</a> <a class="btn-flat white-text" onclick="bulkDelete()"><i class="material-icons left">delete</i>削除</a> <a class="btn-flat white-text" onclick="clearSelection()" style="margin-left:10px;opacity:.8"><i class="material-icons left">close</i>選択解除</a></div></div></div><div id="linkModal" class="modal modal-fixed-footer"><div class="modal-content"><div class="modal-header-actions"><h5 id="modalTitle">リンク詳細</h5><a class="waves-effect waves-teal btn-flat" onclick="resetCurrentLink()" title="このリンクを初期状態に戻す"><i class="material-icons left">restore</i>復元</a></div><div class="row"><form class="col s12"><input type="hidden" id="linkId"><div class="input-field col s12"><i class="material-icons prefix">title</i> <input id="inputTitle" type="text" class="validate" oninput="updateLinkValueDebounced()"> <label for="inputTitle">タイトル *</label></div><div class="input-field col s12"><i class="material-icons prefix">link</i> <input id="inputUrl" type="text" class="validate" oninput="updateLinkValueDebounced()"> <label for="inputUrl">URL *</label></div><div class="col s12 tag-section"><i class="material-icons prefix">label</i><div class="tag-section-body"><span class="tag-label">タグ (Enterで追加)</span><div id="tagChips" class="chips"></div><datalist id="tagListSuggestions"></datalist></div></div><div class="input-field col s12"><i class="material-icons prefix">short_text</i> <textarea id="inputDesc" class="materialize-textarea" oninput="updateLinkValueDebounced()"></textarea> <label for="inputDesc">概要</label></div><div class="input-field col s12"><i class="material-icons prefix">comment</i> <textarea id="inputRemarks" class="materialize-textarea" placeholder="メモや補足情報など" oninput="updateLinkValueDebounced()"></textarea> <label for="inputRemarks">備考</label></div><div class="col s12 center-align" style="margin-top:10px"><a class="waves-effect waves-light btn indigo darken-1" onclick="openCurrentUrl()"><i class="material-icons left">open_in_new</i>このページを開く</a></div></form></div></div><div class="modal-footer"><a href="#!" class="modal-close waves-effect waves-red btn-flat left red-text" onclick="deleteLinkInModal()">削除</a> <a href="#!" class="modal-close waves-effect waves-green btn-flat">閉じる</a></div></div><div id="bulkTagModal" class="modal" style="max-width:450px"><div class="modal-content"><h5>タグの一括追加</h5><p class="grey-text">選択したリンクに、以下のタグを追加します。<br>（既存のタグは消えません）</p><div style="margin-top:16px;margin-bottom:8px"><label style="font-size:.8rem;display:block;margin-bottom:4px">選択中のリンクに含まれるタグ (クリックで入力):</label><div id="bulkReferenceTags" style="display:flex;flex-wrap:wrap;gap:6px"></div></div><div style="margin-top:20px"><div id="bulkTagChips" class="chips"></div><span class="grey-text text-lighten-1" style="font-size:.8rem">Enterキーでタグを確定してください</span></div></div><div class="modal-footer"><a href="#!" class="modal-close waves-effect waves-grey btn-flat">キャンセル</a> <a href="#!" class="modal-close waves-effect waves-green btn-flat" onclick="applyBulkTags()">追加する</a></div></div><div id="bulkTagDeleteModal" class="modal" style="max-width:450px"><div class="modal-content"><h5>タグの一括削除</h5><p class="grey-text">選択したリンクから、以下のタグを削除します。<br>（指定したタグ以外は残ります）</p><div style="margin-top:16px;margin-bottom:8px"><label style="font-size:.8rem;display:block;margin-bottom:4px">選択中のリンクに含まれるタグ (クリックで選択):</label><div id="bulkDeleteReferenceTags" style="display:flex;flex-wrap:wrap;gap:6px"></div></div><div style="margin-top:20px"><div id="bulkTagDeleteChips" class="chips"></div><span class="grey-text text-lighten-1" style="font-size:.8rem">Enterキーでタグを確定してください</span></div></div><div class="modal-footer"><a href="#!" class="modal-close waves-effect waves-grey btn-flat">キャンセル</a> <a href="#!" class="modal-close waves-effect waves-red btn-flat" onclick="applyBulkTagDelete()">削除する</a></div></div><div id="importChoiceModal" class="modal"><div class="modal-content"><h4>JSON読込モードの選択</h4><p>読み込んだデータをどのように処理しますか？</p><p class="grey-text text-darken-1">ファイル内データ件数: <span id="importCount" style="font-weight:700">0</span> 件</p></div><div class="modal-footer" style="text-align:center"><a href="#!" class="modal-close waves-effect waves-green btn-flat" onclick='resolveImport("append")'><i class="material-icons left">playlist_add</i>既存リストに追加</a> <a href="#!" class="modal-close waves-effect waves-red btn-flat" onclick='resolveImport("replace")'><i class="material-icons left">delete_sweep</i>全て置き換え</a> <a href="#!" class="modal-close waves-effect waves-grey btn-flat" onclick='resolveImport("cancel")'>キャンセル</a></div></div><div id="infoModal" class="modal modal-fixed-footer"><div class="modal-content"><h4>Information</h4><div class="row"><div class="col s12"><ul class="tabs"><li class="tab col s6"><a class="active" href="#help">使い方</a></li><li class="tab col s6"><a href="#changelog">変更履歴</a></li></ul></div><div id="help" class="col s12 info-section"></div><div id="changelog" class="col s12 info-section"><ul class="collection" id="changelogList"></ul></div></div></div><div class="modal-footer"><a href="#!" class="modal-close waves-effect waves-green btn-flat">閉じる</a></div></div><script src="https://code.jquery.com/jquery-3.6.0.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script><script id="initial-state">window.savedData=null</script></body></html>